# Qwen2-vl-sft
This repository contains a project I completed during my internship at meituan. 

Specifically, it performs SFT on Qwen2-vl, uses internal company data, that is fine-tunes Qwen2-vl for downstream tasks (labeling). 

It is tested on a dedicated dataset and can outperform GPT-4o.

The test accuracy:

| model/dataset                | mean_score               | lixi_test_1229_183191 | face_disney_pixal_boys_183111 | secure_sexyxjj_fp_1222_182501 | secure_sexyxjj_fn_1222_182443 | secure_white_pic_230711_2000_181421 | secure_white_pic_230711_2000_181422 | ocr_sec_txiang_contact_231218_181486 | secure_normal_trainset_180944 | secure_normal_validset_180821 | face_huhang_helmet_tie_train_3_183171 | face_pixar_20231207_180654 | gun_knife_detec_co_1_179790 | secure_xjj_compensate_1206_180420 | face_pattern_mask_2023_179911 | draw_240_round2_eyeball_crop_filter_outer_179901 | image_app_tagreversenormal_1018_1025_5k_179059 | secure_logop2p3_cls_v3_diedai_crop_178502 | ocr_sec_txiang_contact_231128_178725 | ocr_sec_txiang_lowrisk_231128_178416 | secure_smoke_detection_v10_178130 |
|------------------------------|--------------------------------|-----------------------|-------------------------------|-------------------------------|-------------------------------|---------------------------------------|---------------------------------------|---------------------------------------|-----------------------------|-----------------------------|--------------------------------------------|---------------------------|----------------------------|-------------------------------|---------------------------|----------------------------------------------|----------------------------------------------|---------------------------------------------|---------------------------------------------|---------------------------------------------|---------------------------------------------|
| gpt4o                        | 68.2                           | 94                    | 60                            | 51                            | 80                            | 70.8                                  | 98                                    | 0(违规信息)                           | 89                          | 89                          | 30                                         | 31                        | 84                         | 44                            | 97                        | 0(无法推理)                                          | 18                                           | 63                                        | 79                                          | 90                                          | 60                                          |
| Qwen2-vl                     | 23.9                           | 0                     | 44.2                          | 4.6                           | 75.4                          | 12.5                                  | 13.8                                  | 91.2                                  | 43.4                        | 41                          | 25.6                                       | 15.2                      | 0                          | 1                             | 87.2                      | 4.12                                             | 1.8                                          | 97.4                                     | 13.8                                       | 3.2                                        | 0.6                                         |
| Qweb2-vl-mix(1000)           | 58.1                           | 89.4                  | 36.4                          | 67.8                          | 80.8                          | 75                                   | 93.2                                  | 56.2                                  | 78.4                        | 82.6                        | 58.8                                       | 16.6                      | 56.2                       | 69                            | 99.2                      | 2.6                                              | 13.4                                         | 98                                        | 1                                          | 11                                         | 20.2                                        |
| Qweb2-vl-mix(2000)           | 62.2                           | 72                    | 9.6                           | 67.8                          | 83.6                          | 72.9                                  | 97.4                                  | 87.8                                  | 92.6                        | 93.4                        | 62.2                                       | 16.6                      | 28                         | 66.4                          | 99.8                      | 3.47                                             | 54.2                                         | 98                                        | 19.6                                       | 66.4                                       | 19.8                                        |
| Qweb2-vl-mix(3000)           | 69.1                           | 86                    | 56                            | 67.8                          | 82.6                          | 70.8                                  | 97.6                                  | 90.6                                  | 93                          | 92.4                        | 67                                         | 16.6                      | 81.2                       | 66.2                          | 99.6                      | 5.21                                             | 60                                           | 98                                        | 19.2                                       | 69.8                                       | 21.2                                        |
| Qweb2-vl-mix(3370)           | 67.8                           | 76.2                  | 56                            | 67.8                          | 81.4                          | 72.9                                  | 96.6                                  | 90.6                                  | 90.6                        | 92.6                        | 66.2                                       | 16.6                      | 76                         | 66.6                          | 99.6                      | 4.99                                             | 59.2                                         | 98                                        | 18.8                                       | 68                                         | 19                                          |
| Qweb2-vl-full(1000)          | 41.0                           | 0                     | 0                             | 51                            | 79.4                          | 58.3                                  | 88.6                                  | 5                                     | 45.2                        | 45.6                        | 37                                         | 16.6                      | 0                          | 61.6                          | 99                        | 0                                                | 6.4                                          | 97.4                                     | 14                                         | 7.2                                        | 31.4                                        |
| Qweb2-vl-full(2000)          | 55.4                           | 2.2                   | 57.6                          | 67.8                          | 80                            | 62.5                                  | 93.4                                  | 90.4                                  | 82.8                        | 88.2                        | 30.8                                       | 16.6                      | 10.2                       | 66.4                          | 99.2                      | 5.21                                             | 35.2                                         | 98.2                                     | 19.4                                       | 73.4                                       | 14.2                                        |
| Qweb2-vl-full(3000)          | 62.0                           | 92.4                  | 46.2                          | 67.8                          | 80.6                          | 62.5                                  | 91.8                                  | 83.8                                  | 83.8                        | 88                          | 31.8                                       | 16.4                      | 62.6                       | 71.6                          | 99.2                      | 5.21                                             | 23.8                                         | 98                                        | 19                                         | 50.6                                       | 30                                          |
| Qweb2-vl-full(3370)          | 64.9                           | 97.6                  | 44                            | 67.8                          | 80.8                          | 62.5                                  | 92.4                                  | 84.6                                  | 84.6                        | 89.2                        | 60.8                                       | 16                        | 70.4                       | 71                            | 99.2                      | 16.9                                             | 26.2                                         | 98.2                                     | 20.8                                       | 56                                         | 31                                          |

The main training code is copyed from LLaMA-Factory.
